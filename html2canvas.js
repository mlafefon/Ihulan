!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).html2canvas=e()}(this,(function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e={};function n(t,e){var n=t.cssText;if(e)for(var r in e)e.hasOwnProperty(r)&&(n=n.replace(new RegExp(r.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),e[r]));return n}function r(t,e){return t.replace(new RegExp("("+e.join("|")+")","g"),"")}var i={};function o(t,e,n,r){var i=e.length,o=0;return new Promise((function(s,a){var c=function(){var e=t.slice(o,o+=n);o>i?s():Promise.all(e.map(r)).then(c).catch(a)};c()}))}var s=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e};function a(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];if(Array.isArray(i))e.push.apply(e,a(i));else e.push(i)}return e}function c(t){return null==t?[]:[].concat(t)}var u=function(){return"undefined"!=typeof window},l=function(t){return new Promise((function(e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){200===r.status?e(r.response):n("Failed to load image "+t+" with status "+r.status)},r.onerror=n,r.send()}))},f=function(t){switch(t.substring(0,5)){case"data:":var e=t.indexOf(",",5);return t.substring(5,e);case"blob:":return t.match(/type=([^;]*)/)[1]}},h=function(t){return new Promise((function(e){var n=new FileReader;n.onloadend=function(){e(n.result)},n.readAsDataURL(t)}))},p=function(t){for(var e=atob(t),n=e.length,r=new Uint8Array(n);n--;)r[n]=e.charCodeAt(n);return r},d=function(t,e){var n=f(t);return new Blob([p(t.substring(t.indexOf(",",5)+1))],{type:n||e})};"function"==typeof t.define&&t.define.amd&&t.define("stackblur-canvas",t),t.StackBlur=t.StackBlur||{};var g,m=[[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,2,2,2,2,2,2,2,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1]],v=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0],[0,0,0,1,1,1,0,0,0],[0,0,0,0,1,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]],y={};function b(t,e){var n,r,i,o,s,a,c,u,l,f,h,p,d,g,m,v=t.data,y=t.width,b=t.height,x=e+e+1,w=y-1,C=b-1,E=e+1,k=E*E,S=k>>1,T=new Array(k),A=new Array(k),P=new Array(k),R=new Array(x),O=new Array(x),L=new Array(x),I=0;for(s=0;s<k;s++)T[s]=s/k,A[s]=T[s]*T[s],P[s]=A[s]*T[s];for(a=0;a<b;a++){for(o=m=g=d=p=h=f=l=u=c=0,s=-e;s<=e;s++)n=(m-o)*v[I=Math.max(0,o)<<2]+v[I+1],r=v[I+2],i=v[I+3],u+=n,c+=r,l+=i,f+=n*n,h+=r*r,p+=i*i,d+=n*r,g+=n*i,m+=r*i,s>0&&(o++,I+=4),O[s+e]=n,L[s+e]=r,R[s+e]=i;for(o=0;o<y;o++){v[I]=u,v[I+1]=c,v[I+2]=l,v[I+3]=f,I+=4;var _=o+E;n=O[_%x],r=L[_%x],i=R[_%x],u-=O[(s=_-(e+1))%x],c-=L[s],l-=R[s],s=o-e-1,f-=A[n]*n+d-A[c]*c-A[i]*i,h-=n*c,p-=n*i,d-=c*i,O[_%x]=n,L[_%x]=r,R[_%x]=i,m=g,g+=d-g,d+=u-d,u+=n-v[I=w<<2],c+=r-v[I+1],l+=i-v[I+2],m=o,I=(a*y+o)*4,u+=O[(m+e)%x],c+=L[(m+e)%x],l+=R[(m+e)%x],f+=A[O[(m+e)%x]]+A[L[(m+e)%x]]+A[R[(m+e)%x]],d+=L[(m+e)%x]*O[(m+e)%x],g+=R[(m+e)%x]*O[(m+e)%x],m+=L[(m+e)%x]*R[(m-1+y)%y]}}for(o=0;o<y;o++){for(a=0;a<b;a++)I=(a*y+o)*4,v[I]=(T[v[I]]-1)*255,v[I+1]=T[v[I+1]]*255,v[I+2]=(1-T[v[I+2]])*255}}function x(t,e,n,r,i,o,s){var a,c,u,l,f,h,p,d,g,m=t.data,v=t.width,y=t.height,b=n-1,x=r-1,w=i-1,C=o-1,E=s+s+1,k=v-1,S=y-1,T=s+1,A=T*(T+1)/2,P=new R,R=new P. imagemodified,O=new P.imagedata,L=new Array(E),I=new Array(A);for(p=0;p<A;p++)I[p]=p*p;for(p=h=0;h<y;h++){for(f=l=u=c=a=0,d=-s;d<=s;d++)g=Math.max(0,d),g=4*(Math.min(S,Math.max(0,h+g))*v+p),c+=m[g]*m[g],u+=m[g+1]*m[g+1],l+=m[g+2]*m[g+2],f+=m[g+3]*m[g+3],a++,d>0&&(p++,g+=4);for(p=0;p<v;p++){R[4*p]=c,R[4*p+1]=u,R[4*p+2]=l,R[4*p+3]=f,c-=m[4*(S-h)],u-=m[4*(S-h)+1],l-=m[4*(S-h)+2],f-=m[4*(S-h)+3],g=4*(Math.min(S,h+s+1)*v+p),c+=m[g]*m[g],u+=m[g+1]*m[g+1],l+=m[g+2]*m[g+2],f+=m[g+3]*m[g+3]}}for(p=0;p<v;p++){for(h=0;h<y;h++)g=4*(h*v+p),m[g]=R[4*(h*v)]/a,m[g+1]=R[4*(h*v)+1]/a,m[g+2]=R[4*(h*v)+2]/a,m[g+3]=R[4*(h*v)+3]/a}}function w(t,e,n,r,i,o,s,a,c){for(var u,l,f,h,p,d,g,m=t.data,v=t.width,y=t.height,b=n-1,x=r-1,w=i-1,C=o-1,E=s-1,k=a-1,S=c-1,T=0;T<y;T++)for(var A=0;A<v;A++){var P=4*(T*v+A);u=m[P]/255,l=m[P+1]/255,f=m[P+2]/255,h=m[P+3]/255,p=Math.sqrt(u*u*b+l*l*x+f*f*w+h*h*C),d=Math.sqrt(u*u*E+l*l*k+f*f*S),g=(p-d)/Math.sqrt(127.5),m[P]=127.5+127.5*g,m[P+1]=127.5+127.5*g,m[P+2]=127.5+127.5*g,m[P+3]=255}}function C(t,e){return t.replace(/(\r\n|\n|\r)/gm,"")}var E="acorn",k="Infinity",S="-Infinity",T="NaN",A="\\s",P="[a-zA-Z$_][a-zA-Z0-9$_]*",R="[+-]?(?:[0-9]+(?:\\.[0-9]*)?|\\.[0-9]+)(?:[eE][+-]?[0-9]+)?",O="("+P+")|("+R+")",L=RegExp("("+O+")|((?:(?!<\\s*"+O+"\\s*>)[^>])+>)|(<\\s*("+O+")\\s*>)","g");var I={},_=/^((HTML|XML|Text|Data|URI|Blob|Svg|Canvas|Video|Audio|Image|Promise|DOMPoint|DOMRect|DOMMatrix|CSSRule|CSSStyleDeclaration|CSS2Properties|FormData|File|FileList|FileReader|URL|URLSearchParams|SVGPoint|SVGMatrix|SVGLength|SVGNumber|SVGTransform|SVGAnimatedLength|SVGAnimatedNumber)[a-zA-Z]*|function|var|let|const|for|while|do|if|else|switch|case|break|continue|return|throw|try|catch|finally|new|delete|typeof|void|in|instanceof|true|false|null|undefined|NaN|Infinity)$/i;function M(t,e){if(e)return e;if(!I[t])try{I[t]=new Function("return "+t)}catch(e){I[t]=function(){return t.substring(1,t.length-1)}}return I[t]}function D(t,e,n){return t.map((function(t){var r,i,o=t[0];switch(o){case"string":r=t[1];break;case"number":r=t[1];break;case"boolean":r=t[1];break;case"null":r=null;break;case"undefined":r=void 0;break;case"array":for(r=[],i=0;i<t[1].length;i++)r.push(D([t[1][i]],e,n));break;case"object":for(i in r={},t[1])r[i]=D([t[1][i]],e,n);break;case"variable":r=M(t[1],(n.get(t[1])||{}).value);break;case"function":var s=t[1].args,a=t[1].body;r=function(){var t,r=[],i=new Map(n);for(t=0;t<s.length;t++)i.set(s[t],{value:arguments[t]});for(t=0;t<a.length;t++){var o=D([a[t]],e,i);if(a[t].return)return o}return e.window.Promise.resolve()};break;case"property":r=D([t[1]],e,n)[D([t[2]],e,n)];break;case"call":var c=D([t[1]],e,n),u=D([t[2]],e,n),l=[];for(i=0;i<t[3].length;i++)l.push(D([t[3][i]],e,n));r=c.apply(u,l)}return r}))[0]}var N,B,F,U,$,V,H=/[^\w-]/g;function z(t){return t.replace(H,"_")}var W=/^(data|aria|xlink|xml):/i;function j(t){return W.test(t)?t.split(":")[1]:t}var Y=/[A-Z]/g;function G(t){return t.replace(Y,(function(t){return"-"+t.toLowerCase()}))}var q=/^(?:(?!webkit|moz|ms|o)[A-Z])/,X=/^(aria|data|xml)-/,Z=/^((?:background|border)(?:-image)?|content|cursor|list-style|outline|scroll-snap|text-emphasis|white-space|font|filter|mask|offset|paint-order|shape|stroke|transform|(-webkit-)?(?:mask|clip-path))$/,K={"background-image":!0,"border-image":!0,"border-image-source":!0,"list-style-image":!0,content:!0,cursor:!0},J={"background-image":/url\(([^)]+)\)/gi,"border-image":/url\(([^)]+)\)/gi,"border-image-source":/url\(([^)]+)\)/gi,"list-style-image":/url\(([^)]+)\)/gi,content:/(?:url|image|image-set)\(([^)]+)\)/gi};function Q(t){for(var e=/-(\w)/g,n=t.replace(e,(function(t,e){return e.toUpperCase()})),r={};n;)try{var i=/^([a-zA-Z-0-9]+)\s*:(.+?)(?:;|$)/.exec(n);if(!i)break;r[i[1]]=i[2].trim(),n=n.substring(i[0].length)}catch(t){break}return r}function tt(t){var e={};for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];"string"==typeof r&&(e[n]=r.replace(/"/g,"'").replace(/\n/g,""))}return JSON.stringify(e)}function et(t,e,r){var i,o,s,a=t.split(",");for(i=0;i<a.length;i++)for(o=a[i].trim().split(" "),s=0;s<o.length;s++){var c=o[s].trim();if(c){var u=e.querySelectorAll(c);if(u.length){for(var l=0;l<u.length;l++)if(u[l]===r)return!0}else{var f=n(c,{"-":""});if(e[f]&&e[f]()===r)return!0}}}}function nt(t,e){for(var n,r,i=[],o=t.split(e),s=0;s<o.length;s++){var a=o[s].trim();if(a){var c=/^(\S+)(?:\s+(.+))?$/.exec(a),u=c[1],l=c[2],f=[];if(l)for(var h=l.split(","),p=0;p<h.length;p++){var d=h[p].trim(),g=/^(\S+)(?:\s+(.+))?$/.exec(d),m=g[1],v=g[2];if(v)for(var y=v.split(" "),b=0;b<y.length;b++)f.push({name:m,value:y[b]});else f.push({name:m,value:!0})}i.push({name:u,attributes:f})}}return i}var rt=/^text\/(html|plain|xml|css|javascript|json|event-stream|csv|rtf|vcard|vnd.a|vnd.b|vnd.c|vnd.d|vnd.e|vnd.f|vnd.g|vnd.h|vnd.i|vnd.j|vnd.k|vnd.l|vnd.m|vnd.n|vnd.o|vnd.p|wgsl|x-c|x-c\+\+|x-c-header|x-c-source|x-csharp|x-fortran|x-java-source|x-java|x-javascript|x-pascal|x-python|x-sh|x-tcl)/,it=/^((?!image|video|audio|font|application\/(octet-stream|zip|x-www-form-urlencoded|json|xml|javascript)).*)/,ot=function(t,e){return new Promise((function(n,r){var i=e.createElement("iframe");i.style.visibility="hidden",i.style.width="0px",i.height="0px",i.onload=function(){var e=i.contentDocument.body,r=e.getElementsByTagName("*");if(r.length)for(var o=0;o<r.length;o++)t(r[o]);else t(e);i.parentNode.removeChild(i),n()},i.onerror=function(t){r("Failed to load iframe with "+t)},e.body.appendChild(i)}))};function st(t,e){var n,r=t.split(L);for(n=0;n<r.length;n++){var i=r[n];i&&!/^\s+$/.test(i)&&e(i)}}function at(t,e,n,r,i,o){var s,a,c;for(a=e.length-1;a>=0;a--)if("{"===(c=e[a]).type&&c.level==o)break;for(var u=o+1,l=[],f=[],h=0,p=e.length;h<p;h++)if((s=e[h]).level==u){if("{"==s.type)l.push(h);else if("}"==s.type){var d=l.pop();if(void 0!==d){var g=h-d-1;if(g>0){var m=e.slice(d+1,h),v=r(m,i);t(d,g,v)}}}}for(h=e.length-1;h>=0;h--)if((s=e[h]).level==o&&"{"==s.type&&f.indexOf(h)<0)for(var y=h+1;y<e.length&&e[y].level>o;){var b=e.slice(y,y+=at(t,e,n,r,i,o+1));t(h,b.length,r(b,i))}}var ct=["margin-top","margin-right","margin-bottom","margin-left"],ut=["padding-top","padding-right","padding-bottom","padding-left"],lt=["border-top-width","border-right-width","border-bottom-width","border-left-width"],ft=["border-top-color","border-right-color","border-bottom-color","border-left-color"],ht=["border-top-style","border-right-style","border-bottom-style","border-left-style"],pt=["border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius"];function dt(t,e){if(e.length){var n={};for(var r in t)if(t.hasOwnProperty(r)&&e.indexOf(r)<0)n[r]=t[r];return n}return t}function gt(t,e){var n=t.getPropertyValue(e);if(n&&"none"!==n){var r=/((?:-|\+)?(?:\d*\.)?\d+)(p[xtc]|%|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax)/.exec(n);if(r)return{value:parseFloat(r[1]),unit:r[2]}}return{value:0,unit:"px"}}function mt(t,e,n,r){return e/n*r}function vt(t,e,n){return e/n*100+"%"}var yt=function(t){var e=function(e){if(e)switch(e.nodeName.toLowerCase()){case"style":return!0;case"script":return!0;case"link":if(e.rel)switch(e.rel.toLowerCase()){case"stylesheet":return!0}break;case"meta":if(e.name)switch(e.name.toLowerCase()){case"viewport":return!0}}return!1};return function(n){var r;if(n){if(e(n))return!1;if(n.parentNode)r=n.parentNode.closest("head,body");else{for(var i=n;i.parentNode;)i=i.parentNode;r=i}return r&&"HEAD"!==r.nodeName.toUpperCase()&&"BODY"!==r.nodeName.toUpperCase()}},bt=function(t){var e,n=0;return function r(){var i=Math.min(t.length,n+1e4);if(n>=t.length)return e;for(;n<i;n++)e=t[n](e);return n>=t.length?e:(setTimeout(r,0),e)}},xt=/^(\d{1,3})%,?(\d{1,3})%,?(\d{1,3})%$/,wt=/^(\d{1,3}),?(\d{1,3}),?(\d{1,3})$/,Ct=function(t){return parseFloat(t)/255},Et=function(t){var e=t.match(xt);if(e)return{r:2.55*Number(e[1]),g:2.55*Number(e[2]),b:2.55*Number(e[3])};var n=t.match(wt);return n?{r:Number(n[1]),g:Number(n[2]),b:Number(n[3])}:null},kt=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,St=/#([a-fA-F0-9]{1})([a-fA-F0-9]{1})([a-fA-F0-9]{1})/,Tt=function(t){var e=t.match(kt);if(e)return{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)};var n=t.match(St);return n?{r:parseInt(n[1]+n[1],16),g:parseInt(n[2]+n[2],16),b:parseInt(n[3]+n[3],16)}:null},At=/(rgba?)\(([^)]+)\)/,Pt=function(t){var e=t.match(At);if(e){var n=e[2].split(","),r="rgba"===e[1];return{r:Number(n[0]),g:Number(n[1]),b:Number(n[2]),a:r?Ct(n[3]):void 0}}};function Rt(t){if("transparent"===t)return null;var e=Tt(t);return e||(e=Pt(t))||(e=Et(t)),e}var Ot=function(t){this.color=t},Lt=function(t,e){return t.a=e,t},It=function(t){return"rgba("+(t.r||0)+", "+(t.g||0)+", "+(t.b||0)+", "+(t.a||0)+")"};Ot.prototype.isTransparent=function(){return 0===this.color.a};var _t=function(t,e,n){return{r:t,g:e,b:n}};function Mt(t){var e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Dt(t,e){var n=Mt(t.r),r=Mt(t.g),i=Mt(t.b),o=Mt(e.r),s=Mt(e.g),a=Mt(e.b);return(n*e.a*(1-t.a)+o*t.a*e.a)/t.a*e.a+(n*(1-e.a)+o*e.a)}var Nt=function(t,e){this.src=t,this.image=e};Nt.prototype.isTransparent=function(){return 0===this.image.width&&0===this.image.height};var Bt=function(){this._hasOverflow=this._hasScroll=this._clip=this._width=this._height=this._top=this._left=this._x=this._y=0};Bt.prototype.add=function(t,e,n,r,i,o){this._left=Math.min(this._left,t),this._top=Math.min(this._top,e),this._width=Math.max(this._width,n),this._height=Math.max(this._height,r),this._hasScroll=this._hasScroll||i,this._hasOverflow=this._hasOverflow||o};var Ft=function(){this._storage={},this.length=0};Ft.prototype.get=function(t){var e=this._storage[t];return e||(e=this._storage[t]={value:t},this.length++),e};var Ut=Ft,$t=function(){function t(e){var n;void 0===e&&(e={}),this._options=e,this.context=e.context||t.context,this._cacheStorage=new this.context.CacheStorage(e),this._queue=[],this._processing=!1,this._logging=(n=this._options.logging,Boolean("undefined"==typeof n||n)),this._window=this._options.window||this.context.window,this._document=this._options.document||this.context.document,this._fontMetrics=new this.context.FontMetrics(this._document)}return t.prototype.render=function(t,e){var n=this;return this._processing=!0,this._options.onrendered=this._options.onrendered||function(){},new Promise((function(r,i){var o=new n.context.NodeParser(t,n,e);n._queue.push(o),n._processing=!1,n.run()}))},t.prototype.run=function(){var t=this;if(!this._processing&&this._queue.length){var e=this._queue.shift();this._processing=!0,e.ready.then((function(n){var r=t.renderElement(n);return t._options.onrendered(r),r})).then((function(){t._processing=!1,t.run()}))}},t.prototype.renderElement=function(t){var e=this;this._log("Starting DOM-to-canvas rendering"),this._options.backgroundColor=this._options.backgroundColor||4294967295;var n=this._options.width||function(t){return e._window.innerWidth}(t),r=this._options.height||function(t){return e._window.innerHeight}(t),i=this.createCanvas(n,r),o=new this.context.CanvasRenderer(i,this._options);return o.render(t),i},t.prototype.createCanvas=function(t,e){var n=this._document.createElement("canvas");return n.width=this._options.width||t,n.height=this._options.height||e,n},t.prototype.loadImage=function(t){return this._cache.loadImage(t)},t.prototype._log=function(){var t=this;u()&&this._logging&&this.context.window.console.log.apply(this.context.window.console,["html2canvas:"].concat(s(arguments)).map((function(e){return"string"==typeof e?e:e instanceof t._document.defaultView.Node?e.nodeName.toLowerCase()+(e.id?"#"+e.id:"")+(e.className?"."+e.className.toString().split(" ").join("."):""):e})))},t}(),Vt=function(t){this.id=this.createUUID(),this.type=t};Vt.prototype.createUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},Ht=function(t,e){this.message=t,this.stack=e},zt=function(t){this.value=t};function Wt(t,e,n){return new Promise((function(r){var i,o,s,a=new FileReader;a.onload=function(){var e=a.result,n=new Uint8Array(e);if(i=n.length,o=new Array(i),s=new DataView(e),t(n,o,s)){var c=new Blob([new Uint8Array(o,0,i)],{type:"image/png"});r(c)}},a.onerror=function(t){reject(t)},a.readAsArrayBuffer(d(e,n))}))}var jt,Yt=function(){this.x=this.y=this.width=this.height=0};Yt.prototype.add=function(t){this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.width=Math.max(this.width,t.x+t.width),this.height=Math.max(this.height,t.y+t.height)};var Gt={};Gt.Proxy=function(t,e){var n,r;return n=e.createElement("script"),r=e.createTextNode("(function() {var images = [], r = Math.random();this.Proxy = function(src, options) {var script = document.createElement('script');script.src = src + (src.indexOf('?') > -1 ? '&' : '?') + 'r=' + r + (options.get ? '&' + options.get : '');document.head.appendChild(script);};this.Proxy.callback = function(jsonp) {images.push(jsonp);};this.Proxy.images = images;})()"),n.appendChild(r),n},Gt.Proxy.Promise=function(t,e,n){var r,i,o;return n.createElement("script"),r=n.createElement("script"),i=n.createTextNode("this.Proxy.callback(JSON.parse('"+tt(e)+"'));"),r.appendChild(i),o=n.createElement("script"),o.src=t,o.async=!0,o.onload=function(){r.parentNode&&r.parentNode.removeChild(r)},o.onerror=function(){r.parentNode&&r.parentNode.removeChild(r)},[r,o]};var qt=function(t){return new Promise((function(e,n){var r=new t.window.Image;r.onload=function(){e(r)},r.onerror=n,r.src=t.src,r.complete&&e(r)}))};function Xt(t,e,n,r,i){var o=n*i,s=r*i,a=e.createElement("canvas");return a.width=Math.floor(o),a.height=Math.floor(s),a.style.width=n+"px",a.style.height=r+"px",a.getContext("2d").setTransform(i,0,0,i,0,0),a}function Zt(t,e,n){var r=t.width,i=t.height,o=Math.max(r,i),s=Math.min(r,i),a=Math.round(s/o*255);return function(t,e,n){var r=t.data,i=t.width,o=t.height;try{var s=function(t,e,n,r){for(var i=[],o=0;o<n;o++)for(var s=0;s<e;s++){var a=4*(o*e+s);i.push({r:t[a],g:t[a+1],b:t[a+2],a:t[a+3]})}return i}(r,i,o,n);return function(t,e,n,r){for(var i=0;i<n;i++)for(var o=0;o<e;o++){var s=t[i*e+o];r.push(s.r),r.push(s.g),r.push(s.b),r.push(s.a)}}([],0,i,o,s,r),new Uint8ClampedArray(s)}catch(t){return new Uint8ClampedArray(r)}}(function(t,e,n,r){for(var i=t.data,o=t.width,s=t.height,a=0;a<s;a++)for(var c=0;c<o;c++){var u=4*(a*o+c),l=i[u],f=i[u+1],h=i[u+2],p=i[u+3];if(l!==e||f!==n||h!==r)return!1}return!0})(t,255,255,255)?null:e.window.Promise.resolve(new e.window.Image).then((function(n){return function(t,e,n){try{var r,i,o,s,a=new e.window.DOMParser,c=a.parseFromString(t,"text/xml"),u=c.documentElement;return u.setAttribute("width",n.width),u.setAttribute("height",n.height),r=new e.window.XMLSerializer,i=r.serializeToString(u),o="data:image/svg+xml;base64,",s=e.window.btoa(i),o+s}catch(t){return"data:image/svg+xml,"}}(t,e,n)}))}var Kt=[["background-clip","background-origin","background-size"],["-webkit-background-clip","-webkit-background-origin","-webkit-background-size"],["-moz-background-clip","-moz-background-origin","-moz-background-size"]],Jt=function(t,e,n,r,i,o,s,a){var c,u,l=function(t,e,n){var r=Math.round,i=Math.sqrt,o=Math.pow;return r(i(o(e.x-t.x,2)+o(e.y-t.y,2)))<=r(n)?!0:void 0}(t,e,n);for(c=0;c<r.length;c++)for(u=0;u<i.length;u++)l=l||function(t,e,n,r,i,o){var s=Math.round,a=Math.sqrt,c=Math.pow,u=Math.abs;if(u(e.x-t.x)<i&&u(e.y-t.y)<o){var l=r/i,f=n/o;if(s(c(e.x-t.x,2)*f+c(e.y-t.y,2)*l)<=s(c(i,2)*f+c(o,2)*l))return!0}return!1}(t,e,o,s,r[c],i[u]);return l||function(t,e,n,r,i,o,s,a){var c=Math.pow,u=Math.abs;return u(e.x-t.x)>i||u(e.y-t.y)>o?!1:c(e.x-t.x,2)/c(i,2)+c(e.y-t.y,2)/c(o,2)<=1}(t,e,0,0,0,0,0,0)?function(t,e,n,r,i,o,s,a){var c=Math.round,u=t.getContext("2d");return u.drawImage(e,n,r,i,o,s,a,i,o),c(u.getImageData(s,a,1,1).data[3])>0}(a,i[0],0,0,0,0,0,0):l},Qt=function(t){var e,n,r=this;this.canvas=t,this.ctx=t.getContext("2d"),this.taintCtx=document.createElement("canvas").getContext("2d"),this.context=r,this._ignoredElements=this._ignoredElements||[],this.font=null,this.fontStyle=null,this.fontVariant=null,this.fontWeight=null,this.fontSize=null,this.fontFamily=null,this.textDecoration=null,this.textTransform=null,this.textAlign=null,this.letterSpacing=null,this.wordSpacing=null,this.lineHeight=null,this.textShadows=[],this.color=null,this.backgroundClip=null,this.backgroundOrigin=null,this.backgroundSize=null,this.backgroundImage=null,this.backgroundColor=null,this.borderTopWidth=null,this.borderTopStyle=null,this.borderTopColor=null,this.borderRightWidth=null,this.borderRightStyle=null,this.borderRightColor=null,this.borderBottomWidth=null,this.borderBottomStyle=null,this.borderBottomColor=null,this.borderLeftWidth=null,this.borderLeftStyle=null,this.borderLeftColor=null,this.borderTopLeftRadius=null,this.borderTopRightRadius=null,this.borderBottomLeftRadius=null,this.borderBottomRightRadius=null,this.zIndex=null,this.opacity=null,this.boxShadows=[],this.visibility=null,this.transform=null,this.transformOrigin=null,this.clip=null,this.overflow=null,this.quotes=null,this.listStyleType=null,this.listStylePosition=null,this.listStyleImage=null,this._stack={},this.font=n,e={get:function(){return n},set:function(t){var e=t.split(" ");this.fontStyle=/italic|oblique|normal/.exec(e[0]),this.fontVariant=/small-caps|normal/.exec(e[1]),this.fontWeight=/\d{3}|normal|bold|bolder|lighter/.exec(e[2]),this.fontSize=/\d{1,2}px|xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|inherit/.exec(e[3]),this.fontFamily=e.slice(4).join(" ")},enumerable:!0,configurable:!0},Object.defineProperty(this,"font",e)};function te(t){var e=t.length-1,n=t[e];return t.length>0&&t[e].transform&&t.slice(0,e).forEach((function(e){e.transform=t[e].transform?t[e].transform.multiply(n.transform):n.transform})),t}function ee(t,e,n,r,i){var o=n.get(e);if(o){var s=o.value,a=r.css(e),c=i.css(e);if(s.length!==a.length||s.some((function(t,e){return t.value!==a[e].value}))||c.length!==a.length||c.some((function(t,e){return t.value!==a[e].value}))){var u=new Map;u.set(e,{value:i.css(e)}),t.set(e,u)}}else{var l=new Map;l.set(e,{value:i.css(e)}),n.set(e,l)}}function ne(t,e){return t.get(e)}var re=function(t,e){var n=t.match(/^(-?[\d\.]+)px$/);if(n)return Number(n[1]);var r=16;try{var i=e.defaultView.getComputedStyle(e.body,null);i&&(r=parseFloat(i.getPropertyValue("font-size")))}catch(t){}return/^(-?[\d\.]+)em$/.test(t)?1*r:Number(t)};function ie(t){var e,n,r,i=t.length,o=0;if(i>0)for(e=0;e<i;e++)n=t[e].width,r=t[e].color.a,o+=n*r;return o}var oe=/^linear-gradient\((.+)\)$/,se=/^(repeating-)?linear-gradient\((.+)\)$/,ae=/^radial-gradient\((.+)\)$/,ce=/^(repeating-)?radial-gradient\((.+)\)$/,ue=function(t){var e=t.match(oe);if(e)return{type:"linear",value:le(e[1])};var n=t.match(se);if(n)return{type:"linear",value:le(n[2]),repeat:!!n[1]};var r=t.match(ae);if(r)return{type:"radial",value:he(r[1])};var i=t.match(ce);return i?{type:"radial",value:he(i[2]),repeat:!!i[1]}:null};function le(t){for(var e=[],n=t.split(/,(?![^(]*\))/),r=0;r<n.length;r++){var i=n[r].trim().split(" "),o=i[0].trim();if(o.match(/^(?:to|from)\s+/))e.push({direction:o});else if(o.match(/^((?:-|\+)?(?:\d*\.)?\d+)(?:deg|grad|rad|turn)$/)){var s=o.match(/^((?:-|\+)?(?:\d*\.)?\d+)(deg|grad|rad|turn)$/);e.push({angle:s})}else if(o.match(/^((?:-|\+)?(?:\d*\.)?\d+)(p[xtc]|%|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax)$/)){var a=o.match(/^((?:-|\+)?(?:\d*\.)?\d+)(p[xtc]|%|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax)$/);e.push({distance:a})}else e.push(pe(i))}return e}function fe(t){for(var e,n=[],r=0;r<t.length;r++){var i=t[r].trim();if(i.match(/^(?:ellipse|circle)/))e=i;else if(i.match(/^(?:(?:farthest|closest)-(?:side|corner))/))e?e+=" "+i:n.push({shape:i});else if(i.match(/^(?:at\s+)/))e?e+=" "+i:n.push({position:i.replace(/^(?:at\s+)/,"")});else n.push(pe(i.split(" ")))}return e&&n.push({shape:e}),n}function he(t){for(var e=[],n=t.split(/,(?![^(]*\))/),r=0;r<n.length;r++){var i=n[r].trim().split(" "),o=i[0];if(r>0)e.push(pe(i));else{var s=fe(i);s.length>0&&e.push.apply(e,s)}}return e}function pe(t){for(var e,n,r=t[0],i=t[1],o=Rt(r),s=0;s<t.length;s++){var a=t[s];if(a.match(/^((?:-|\+)?(?:\d*\.)?\d+)%$/)){var c=a.match(/^((?:-|\+)?(?:\d*\.)?\d+)%$/);i=c[1]+"%"}}return{color:new Ot(o),stop:i}}function de(t,e){return function(n,r){var i,o,s,a=r(n,e).reduce((function(e,n){return e[n.name]=n.value,e}),{});if(i=ge(t,a,r)){for(o in i)i.hasOwnProperty(o)&&(s=i[o],t.style.setProperty(o,s));return!0}}}var ge=function(t,e){return{}};function me(t,e){return t.reduce((function(t,n){var r=e[n];return r&&(t[n]=r.slice(0).reverse()),t}),{})}var ve,ye,be,xe,we,Ce=function(t,e){var n,r,i=t.length,o=e.length;for(n=0;n<i&&n<o;++n)if(t[n]!==e[n])return!1;return i===o},Ee=function(t){var e={};return function(n){for(var r,i,o,s=[],a=n.length,c=0;c<a;c++)i=n[c],o=i.value,r=e[o],r||(r=e[o]=[]),r.push(i);var u={};for(r in e){if(e[r].length>t){o=r;var l=-1,f=-1;for(c=0;c<e[r].length;c++)"background-image"===e[r][c].name?l=c:"-webkit-background-image"===e[r][c].name&&(f=c);l>-1&&f>-1&&s.push(e[r][f])}}var h=[];for(r in e)e[r].length<=t&&[].push.apply(h,e[r]);var p,d,g,m,v,y={};return h.concat(s).forEach((function(t){if("background-image"!==t.name&&"-webkit-background-image"!==t.name||(p=t.name,d=t.value,g=/url\("([^"]+)"\)/.exec(d))&&g[1]&&(m=g[1],(v=u[m])||(v=u[m]=[]),v.push(p)),!g)){if(!d.match(/gradient/i))return;y[d]?y[d].push(t.name):y[d]=[t.name]}})),Object.keys(y).forEach((function(e){var n=y[e];n.length>1&&-1!==n.indexOf("-webkit-background-image")&&n.forEach((function(e){"background-image"!==e&&h.splice(h.indexOf(e),1)}))})),{backgroundImage:u,other:h}},ke=["background-color","background-image","background-repeat","background-position","background-attachment"],Se=/^((?:-|\+)?(?:\d*\.)?\d+)(p[xtc]|%|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax)$/,Te=function(t){var e,n=Se.exec(t);return n?{value:n[1],unit:n[2]}:("auto"===t?e="auto":"0"===t?e=0:t.match(/^(?:top|left|right|bottom|center)$/)?e=t:t.match(/^\d+$/)&&(e=parseInt(t,10)),{value:e,unit:void 0})},Ae=function(t){if(t){var e=t.split(" "),n=[];if(1===e.length)n.push(Te(e[0])),n.push(Te("50%"));else if(2===e.length)n.push(Te(e[0])),n.push(Te(e[1]));else if(4===e.length){var r=Te(e[0]);"left"===r.value?r.value=0:("right"===r.value||"bottom"===r.value)&&(r.value=100,r.unit="%");var i=Te(e[1]);r.value=i;var o=Te(e[2]);"left"===o.value?o.value=0:("right"===o.value||"bottom"===o.value)&&(o.value=100,o.unit="%");var s=Te(e[3]);o.value=s,n.push(r),n.push(o)}return n}},Pe=function(t,e){return"border-box"===t?e.width:e.width-e.padding.left-e.padding.right-e.border.left-e.border.right},Re=function(t,e){return"border-box"===t?e.height:e.height-e.padding.top-e.padding.bottom-e.border.top-e.border.bottom},Oe=function(t,e,n,r,i){var o,s,a=Pe(e,n),c=Re(e,n);switch(r.unit){case"%":o=a*r.value/100;break;case"px":o=r.value;break;default:o=r.value}switch(i.unit){case"%":s=c*i.value/100;break;case"px":s=i.value;break;default:s=i.value}return{x:o,y:s}},Le=/^((?:-|\+)?(?:\d*\.)?\d+)(p[xtc]|%|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax)\s+((?:-|\+)?(?:\d*\.)?\d+)(p[xtc]|%|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax)$/,Ie=/^(contain|cover)$/,_e=function(t){var e,n,r,i,o=t.split(" "),s=[];for(e=0;e<o.length;e++)n=o[e],(r=Ie.exec(n))?s.push({value:r[1],unit:void 0}):(i=Le.exec(n))?s.push({x:Te(i[1]+i[2]),y:Te(i[3]+i[4])}):s.push(Te(n));return s},Me=function(t,e,n){var r,i,o,s,a=n.width,c=n.height,u=_e(t),l=u[0],f=l.x?l.x:l,h=l.y?l.y:{value:f.value,unit:f.unit};switch(r=e.width,i=e.height,o=f.value,s=h.value,"cover"===t?r/i>=a/c?s=h.unit=i:o=f.unit=r:"contain"===t&&(r/i>=a/c?o=f.unit=r:s=h.unit=i),f.unit){case"%":a*=o/100;break;case"px":a=o;break;case"auto":a=r}switch(h.unit){case"%":c*=s/100;break;case"px":c=s;break;case"auto":c=i}return{width:a,height:c}},De=function(t,e,n,r,i,o){var s,a,c,u=n,l=e.length,f=0,h=0;if(0===l)return u;for(s=0;s<l;s++)if(c=e[s],a=void 0!==c.stop?c.stop:s/(l-1),u.addColorStop(a,c.color.toString()),"linear"===t){if(c.distance)h=c.distance.value;else if(c.angle){var p=c.angle,d=p.unit;switch(d){case"deg":f=p.value;break;case"rad":f=180*p.value/Math.PI;break;case"grad":f=45*p.value;break;case"turn":f=360*p.value}}else if(c.direction){var g=c.direction;g.match(/top/)&&(f+=180),g.match(/left/)&&(f+=90),g.match(/right/)&&(f+=270)}}var m,v,y,b,x,w,C=r.width,E=r.height,k=Math.sin,S=Math.cos,T=Math.PI;if("linear"===t){var A=(C-i.x-h*S(f*T/180))*S(f*T/180)+(E-i.y-h*k(f*T/180))*k(f*T/180);m=i.x+h*S(f*T/180),v=i.y+h*k(f*T/180),y=i.x+A*S(f*T/180),b=i.y+A*k(f*T/180)}else if("radial"===t){var P=Math.sqrt,R=Math.pow;x=(C+E)/2,w=P(R(C/2,2)+R(E/2,2)),m=i.x,v=i.y,y=i.x,b=i.y}var O=u.createLinearGradient(m,v,y,b);if("radial"===t)for(s=0;s<l;s++)c=e[s],a=void 0!==c.stop?c.stop:s/(l-1),O.addColorStop(a/x*w,c.color.toString());else for(s=0;s<l;s++)c=e[s],a=void 0!==c.stop?c.stop:s/(l-1),O.addColorStop(a,c.color.toString());return O},Ne=function(){function t(e,n){void 0===n&&(n={}),this.node=e,this.options=n,this.context=n.context,this.image=null,this.tainted=null,this._replaced=null,this.isLoaded=!1}return t.prototype.get=function(){var t=this,e=this.node;return this.isLoaded?this.context.window.Promise.resolve(this):this.tainted?this.context.window.Promise.reject(this.tainted):e.isLoaded?this.context.window.Promise.resolve(this):"IMG"===e.nodeName?this.context.imageLoader.load(e):this.context.window.Promise.resolve(this.node).then((function(e){return t.context.renderer.renderNode(e).then((function(e){return t.image=e,t.isLoaded=!0,t}))}))},t}()}(),
